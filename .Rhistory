align = T, hjust = 'centre', offset.text = 0.001, offset = 0.004, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 179, label = 'Adriatic Lineage', color = '#DC4437',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.004, barsize = 1.5,
angle = -75, family = 'Times New Roman') +
geom_cladelabel(node = 205, label = 'Marmoratus Lineage', color = '#58508D',
align = T, hjust = 'centre', offset.text = 0.003, offset = 0.004, barsize = 1.5,
angle = -48, family = 'Times New Roman') +
geom_cladelabel(node = 209, label = 'Tigris Lineage', color = '#86D112',
align = T, hjust = 'centre', offset.text = 0.002, offset = 0.004, barsize = 1.5,
angle = -57, family = 'Times New Roman') +
geom_cladelabel(node = 198, label = 'Mediterranean Lineage', color = '#C67ECA',
align = T, hjust = 'centre', offset.text = 0.002, offset = 0.004, barsize = 1.5,
angle = -27, family = 'Times New Roman') +
geom_cladelabel(node = 194, label = 'Dades Lineage', color = '#4385F5',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.004, barsize = 1.5,
angle = -40, family = 'Times New Roman') +
geom_cladelabel(node = 264, label = 'Atlantic Lineage', color = '#109D59',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.004, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 323, label = 'North-African Lineage', color = '#0154A4',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.004, barsize = 1.5,
angle = -47, family =  'Times New Roman')
tree2
## GENERATE TREE ##
tree2 <- ggtree(beast_tree2, aes(color = Lineage), layout = 'circular') +
geom_rootedge(0.002) +
geom_tiplab(size=2, color="black") +
geom_cladelabel(node = 340, label = 'Duero Lineage', color = '#FF6362',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.004, barsize = 1.5,
angle = -69, family = 'Times New Roman') +
geom_cladelabel(node = 211, label = 'Danubian Lineage', color = '#F5B400',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.004, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 179, label = 'Adriatic Lineage', color = '#DC4437',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.004, barsize = 1.5,
angle = -75, family = 'Times New Roman') +
geom_cladelabel(node = 205, label = 'Marmoratus Lineage', color = '#58508D',
align = T, hjust = 'centre', offset.text = 0.003, offset = 0.004, barsize = 1.5,
angle = -48, family = 'Times New Roman') +
geom_cladelabel(node = 209, label = 'Tigris Lineage', color = '#86D112',
align = T, hjust = 'centre', offset.text = 0.002, offset = 0.004, barsize = 1.5,
angle = -57, family = 'Times New Roman') +
geom_cladelabel(node = 198, label = 'Mediterranean Lineage', color = '#C67ECA',
align = T, hjust = 'centre', offset.text = 0.002, offset = 0.004, barsize = 1.5,
angle = -27, family = 'Times New Roman') +
geom_cladelabel(node = 194, label = 'Dades Lineage', color = '#4385F5',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.004, barsize = 1.5,
angle = -40, family = 'Times New Roman') +
geom_cladelabel(node = 264, label = 'Atlantic Lineage', color = '#109D59',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.004, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 323, label = 'North-African Lineage', color = '#0154A4',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.004, barsize = 1.5,
angle = -47, family =  'Times New Roman')
tree2
## GENERATE TREE ##
tree2 <- ggtree(beast_tree2, aes(color = Lineage), layout = 'circular') +
geom_rootedge(0.002) +
geom_tiplab(size=2, color="black") +
geom_cladelabel(node = 340, label = 'Duero Lineage', color = '#FF6362',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.002, barsize = 1.5,
angle = -69, family = 'Times New Roman') +
geom_cladelabel(node = 211, label = 'Danubian Lineage', color = '#F5B400',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.002, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 179, label = 'Adriatic Lineage', color = '#DC4437',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.002, barsize = 1.5,
angle = -75, family = 'Times New Roman') +
geom_cladelabel(node = 205, label = 'Marmoratus Lineage', color = '#58508D',
align = T, hjust = 'centre', offset.text = 0.003, offset = 0.002, barsize = 1.5,
angle = -48, family = 'Times New Roman') +
geom_cladelabel(node = 209, label = 'Tigris Lineage', color = '#86D112',
align = T, hjust = 'centre', offset.text = 0.002, offset = 0.002, barsize = 1.5,
angle = -57, family = 'Times New Roman') +
geom_cladelabel(node = 198, label = 'Mediterranean Lineage', color = '#C67ECA',
align = T, hjust = 'centre', offset.text = 0.002, offset = 0.002, barsize = 1.5,
angle = -27, family = 'Times New Roman') +
geom_cladelabel(node = 194, label = 'Dades Lineage', color = '#4385F5',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.002, barsize = 1.5,
angle = -40, family = 'Times New Roman') +
geom_cladelabel(node = 264, label = 'Atlantic Lineage', color = '#109D59',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.002, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 323, label = 'North-African Lineage', color = '#0154A4',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.002, barsize = 1.5,
angle = -47, family =  'Times New Roman')
tree2
## GENERATE TREE ##
tree2 <- ggtree(beast_tree2, aes(color = Lineage), layout = 'circular') +
geom_rootedge(0.002) +
geom_tiplab(size=2, color="black") +
geom_cladelabel(node = 340, label = 'Duero Lineage', color = '#FF6362',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.003, barsize = 1.5,
angle = -69, family = 'Times New Roman') +
geom_cladelabel(node = 211, label = 'Danubian Lineage', color = '#F5B400',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.003, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 179, label = 'Adriatic Lineage', color = '#DC4437',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.003, barsize = 1.5,
angle = -75, family = 'Times New Roman') +
geom_cladelabel(node = 205, label = 'Marmoratus Lineage', color = '#58508D',
align = T, hjust = 'centre', offset.text = 0.003, offset = 0.003, barsize = 1.5,
angle = -48, family = 'Times New Roman') +
geom_cladelabel(node = 209, label = 'Tigris Lineage', color = '#86D112',
align = T, hjust = 'centre', offset.text = 0.002, offset = 0.003, barsize = 1.5,
angle = -57, family = 'Times New Roman') +
geom_cladelabel(node = 198, label = 'Mediterranean Lineage', color = '#C67ECA',
align = T, hjust = 'centre', offset.text = 0.002, offset = 0.003, barsize = 1.5,
angle = -27, family = 'Times New Roman') +
geom_cladelabel(node = 194, label = 'Dades Lineage', color = '#4385F5',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.003, barsize = 1.5,
angle = -40, family = 'Times New Roman') +
geom_cladelabel(node = 264, label = 'Atlantic Lineage', color = '#109D59',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.003, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 323, label = 'North-African Lineage', color = '#0154A4',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.003, barsize = 1.5,
angle = -47, family =  'Times New Roman')
tree2
tree2$data$posterior <- round(as.numeric(tree2$data$posterior), 2) # ROUND POSTERIOR #
tree2$data$posterior <- tree2$data$posterior*100 # MAKE POSTERIOR AS PERCENTAGE #
tree2_nodes <- tree2 + geom_text2(aes(label = node)) ## Tree with node numbers ##
## ADD POSTERIOR VALUES ##
tree5 <- tree2 +
#geom_text2(aes(label = node))
geom_text2(aes(label = posterior, subset = node %in%
c(177)), hjust = 1.1,vjust= 1.5, color = 'black', size = 2.5, angle = 25) +
geom_text2(aes(label = posterior, subset = node %in%
c(178)), hjust = 1.2, vjust = -.2, color = 'black', size = 2.5, angle = 46) +
geom_text2(aes(label = posterior, subset = node %in%
c(179)), hjust = 1.2, vjust = -.1, color = 'black', size = 2.5, angle = 80) +
geom_text2(aes(label = posterior, subset = node %in%
c(180)), hjust = -.1, vjust = 1.2, color = 'black', size = 2.5, angle = -25) +
geom_text2(aes(label = posterior, subset = node %in%
c(181)), hjust = -.3, vjust = 1.3, color = 'black', size = 2.5, angle = 58) +
geom_text2(aes(label = posterior, subset = node %in%
c(182)), vjust = 1.3, color = 'black', size = 2.5, angle = -65) +
#geom_text2(aes(label = posterior, subset = node %in%
#                         c(195)), vjust = 1.2, color = 'black', size = 2.5, angle = -40) +
geom_text2(aes(label = posterior, subset = node %in%
c(196)), vjust = 1.3, color = 'black', size = 2.5, angle = -40) +
geom_text2(aes(label = posterior, subset = node %in%
c(197)), vjust = 1.3, hjust = -.3, color = 'black', size = 2.5, angle = 58) +
geom_text2(aes(label = posterior, subset = node %in%
c(267)), vjust = 1.3, hjust = 1.1, color = 'black', size = 2.5, angle = 66) +
scale_colour_manual(values = c('#DC4437', '#109D59', '#F5B400', '#4385F5', '#FF8483', '#58508D',
'#C67ECA', '#0154A4', '#3B3B3B' ,'#86D112'),
breaks = c("AD", 'AT', 'DA', 'DS','DU', 'MA', 'ME', 'NA',
'TI') ) +
theme(legend.title = element_text(colour = 'black', size = 10, face='bold'), legend.position = 'bottom',
legend.box = 'horizontal')
tree5
## ADD POSTERIOR VALUES ##
tree5 <- tree2 +
# #geom_text2(aes(label = node))
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(177)), hjust = 1.1,vjust= 1.5, color = 'black', size = 2.5, angle = 25) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(178)), hjust = 1.2, vjust = -.2, color = 'black', size = 2.5, angle = 46) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(179)), hjust = 1.2, vjust = -.1, color = 'black', size = 2.5, angle = 80) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(180)), hjust = -.1, vjust = 1.2, color = 'black', size = 2.5, angle = -25) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(181)), hjust = -.3, vjust = 1.3, color = 'black', size = 2.5, angle = 58) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(182)), vjust = 1.3, color = 'black', size = 2.5, angle = -65) +
# #geom_text2(aes(label = posterior, subset = node %in%
# #                         c(195)), vjust = 1.2, color = 'black', size = 2.5, angle = -40) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(196)), vjust = 1.3, color = 'black', size = 2.5, angle = -40) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(197)), vjust = 1.3, hjust = -.3, color = 'black', size = 2.5, angle = 58) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(267)), vjust = 1.3, hjust = 1.1, color = 'black', size = 2.5, angle = 66) +
scale_colour_manual(values = c('#DC4437', '#109D59', '#F5B400', '#4385F5', '#FF8483', '#58508D',
'#C67ECA', '#0154A4', '#3B3B3B' ,'#86D112'),
breaks = c("AD", 'AT', 'DA', 'DS','DU', 'MA', 'ME', 'NA',
'TI') ) +
theme(legend.title = element_text(colour = 'black', size = 10, face='bold'), legend.position = 'bottom',
legend.box = 'horizontal')
tree5
## SAVE SVG ##
ggsave(filename = "Circular_to_be_edited.svg", width = 11, height = 11, dpi = 320)
getwd()
## SAVE SVG ##
ggsave(filename = "Circular_to_be_edited.tiff", width = 11, height = 11, dpi = 320)
## GENERATE TREE ##
tree2 <- ggtree(beast_tree2, aes(color = Lineage), layout = 'circular') +
geom_rootedge(0.002) +
geom_tiplab(size=2, color="black") +
geom_cladelabel(node = 340, label = 'Duero Lineage', color = '#FF6362',
align = T, hjust = 'centre', offset.text = 0.001, offste = 0.002, barsize = 1.5,
angle = -69, family = 'Times New Roman') +
geom_cladelabel(node = 211, label = 'Danubian Lineage', color = '#F5B400',
align = T, hjust = 'centre', offset.text = 0.001, offste = 0.002, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 179, label = 'Adriatic Lineage', color = '#DC4437',
align = T, hjust = 'centre', offset.text = 0.001, offste = 0.002, barsize = 1.5,
angle = -75, family = 'Times New Roman') +
geom_cladelabel(node = 205, label = 'Marmoratus Lineage', color = '#58508D',
align = T, hjust = 'centre', offset.text = 0.003, offste = 0.002, barsize = 1.5,
angle = -48, family = 'Times New Roman') +
geom_cladelabel(node = 209, label = 'Tigris Lineage', color = '#86D112',
align = T, hjust = 'centre', offset.text = 0.002, offste = 0.002, barsize = 1.5,
angle = -57, family = 'Times New Roman') +
geom_cladelabel(node = 198, label = 'Mediterranean Lineage', color = '#C67ECA',
align = T, hjust = 'centre', offset.text = 0.002, offste = 0.002, barsize = 1.5,
angle = -27, family = 'Times New Roman') +
geom_cladelabel(node = 194, label = 'Dades Lineage', color = '#4385F5',
align = T, hjust = 'centre', offset.text = 0.001, offste = 0.002, barsize = 1.5,
angle = -40, family = 'Times New Roman') +
geom_cladelabel(node = 264, label = 'Atlantic Lineage', color = '#109D59',
align = T, hjust = 'centre', offset.text = 0.001, offste = 0.002, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 323, label = 'North-African Lineage', color = '#0154A4',
align = T, hjust = 'centre', offset.text = 0.001, offste = 0.002, barsize = 1.5,
angle = -47, family =  'Times New Roman')
tree2
## ADD POSTERIOR VALUES ##
tree5 <- tree2 +
# #geom_text2(aes(label = node))
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(177)), hjust = 1.1,vjust= 1.5, color = 'black', size = 2.5, angle = 25) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(178)), hjust = 1.2, vjust = -.2, color = 'black', size = 2.5, angle = 46) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(179)), hjust = 1.2, vjust = -.1, color = 'black', size = 2.5, angle = 80) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(180)), hjust = -.1, vjust = 1.2, color = 'black', size = 2.5, angle = -25) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(181)), hjust = -.3, vjust = 1.3, color = 'black', size = 2.5, angle = 58) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(182)), vjust = 1.3, color = 'black', size = 2.5, angle = -65) +
# #geom_text2(aes(label = posterior, subset = node %in%
# #                         c(195)), vjust = 1.2, color = 'black', size = 2.5, angle = -40) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(196)), vjust = 1.3, color = 'black', size = 2.5, angle = -40) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(197)), vjust = 1.3, hjust = -.3, color = 'black', size = 2.5, angle = 58) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(267)), vjust = 1.3, hjust = 1.1, color = 'black', size = 2.5, angle = 66) +
scale_colour_manual(values = c('#DC4437', '#109D59', '#F5B400', '#4385F5', '#FF8483', '#58508D',
'#C67ECA', '#0154A4', '#3B3B3B' ,'#86D112'),
breaks = c("AD", 'AT', 'DA', 'DS','DU', 'MA', 'ME', 'NA',
'TI') ) +
theme(legend.title = element_text(colour = 'black', size = 10, face='bold'), legend.position = 'bottom',
legend.box = 'horizontal')
tree5
## SAVE SVG ##
ggsave(filename = "Circular_to_be_edited.tiff", width = 11, height = 11, dpi = 320)
## GENERATE TREE ##
tree2 <- ggtree(beast_tree2, aes(color = Lineage), layout = 'circular') +
geom_rootedge(0.002) +
geom_tiplab(size=2, color="black") +
geom_cladelabel(node = 340, label = 'Duero Lineage', color = '#FF6362',
align = T, hjust = 'centre', offset.text = 0.001, offste = 0.0025, barsize = 1.5,
angle = -69, family = 'Times New Roman') +
geom_cladelabel(node = 211, label = 'Danubian Lineage', color = '#F5B400',
align = T, hjust = 'centre', offset.text = 0.001, offste = 0.0025, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 179, label = 'Adriatic Lineage', color = '#DC4437',
align = T, hjust = 'centre', offset.text = 0.001, offste = 0.0025, barsize = 1.5,
angle = -75, family = 'Times New Roman') +
geom_cladelabel(node = 205, label = 'Marmoratus Lineage', color = '#58508D',
align = T, hjust = 'centre', offset.text = 0.003, offste = 0.0025, barsize = 1.5,
angle = -48, family = 'Times New Roman') +
geom_cladelabel(node = 209, label = 'Tigris Lineage', color = '#86D112',
align = T, hjust = 'centre', offset.text = 0.002, offste = 0.0025, barsize = 1.5,
angle = -57, family = 'Times New Roman') +
geom_cladelabel(node = 198, label = 'Mediterranean Lineage', color = '#C67ECA',
align = T, hjust = 'centre', offset.text = 0.002, offste = 0.0025, barsize = 1.5,
angle = -27, family = 'Times New Roman') +
geom_cladelabel(node = 194, label = 'Dades Lineage', color = '#4385F5',
align = T, hjust = 'centre', offset.text = 0.001, offste = 0.0025, barsize = 1.5,
angle = -40, family = 'Times New Roman') +
geom_cladelabel(node = 264, label = 'Atlantic Lineage', color = '#109D59',
align = T, hjust = 'centre', offset.text = 0.001, offste = 0.0025, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 323, label = 'North-African Lineage', color = '#0154A4',
align = T, hjust = 'centre', offset.text = 0.001, offste = 0.0025, barsize = 1.5,
angle = -47, family =  'Times New Roman')
tree2
## GENERATE TREE ##
tree2 <- ggtree(beast_tree2, aes(color = Lineage), layout = 'circular') +
geom_rootedge(0.002) +
geom_tiplab(size=2, color="black") +
geom_cladelabel(node = 340, label = 'Duero Lineage', color = '#FF6362',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -69, family = 'Times New Roman') +
geom_cladelabel(node = 211, label = 'Danubian Lineage', color = '#F5B400',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 179, label = 'Adriatic Lineage', color = '#DC4437',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -75, family = 'Times New Roman') +
geom_cladelabel(node = 205, label = 'Marmoratus Lineage', color = '#58508D',
align = T, hjust = 'centre', offset.text = 0.003, offset = 0.0025, barsize = 1.5,
angle = -48, family = 'Times New Roman') +
geom_cladelabel(node = 209, label = 'Tigris Lineage', color = '#86D112',
align = T, hjust = 'centre', offset.text = 0.002, offset = 0.0025, barsize = 1.5,
angle = -57, family = 'Times New Roman') +
geom_cladelabel(node = 198, label = 'Mediterranean Lineage', color = '#C67ECA',
align = T, hjust = 'centre', offset.text = 0.002, offset = 0.0025, barsize = 1.5,
angle = -27, family = 'Times New Roman') +
geom_cladelabel(node = 194, label = 'Dades Lineage', color = '#4385F5',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -40, family = 'Times New Roman') +
geom_cladelabel(node = 264, label = 'Atlantic Lineage', color = '#109D59',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 323, label = 'North-African Lineage', color = '#0154A4',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -47, family =  'Times New Roman')
tree2
## ADD POSTERIOR VALUES ##
tree5 <- tree2 +
# #geom_text2(aes(label = node))
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(177)), hjust = 1.1,vjust= 1.5, color = 'black', size = 2.5, angle = 25) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(178)), hjust = 1.2, vjust = -.2, color = 'black', size = 2.5, angle = 46) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(179)), hjust = 1.2, vjust = -.1, color = 'black', size = 2.5, angle = 80) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(180)), hjust = -.1, vjust = 1.2, color = 'black', size = 2.5, angle = -25) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(181)), hjust = -.3, vjust = 1.3, color = 'black', size = 2.5, angle = 58) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(182)), vjust = 1.3, color = 'black', size = 2.5, angle = -65) +
# #geom_text2(aes(label = posterior, subset = node %in%
# #                         c(195)), vjust = 1.2, color = 'black', size = 2.5, angle = -40) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(196)), vjust = 1.3, color = 'black', size = 2.5, angle = -40) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(197)), vjust = 1.3, hjust = -.3, color = 'black', size = 2.5, angle = 58) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(267)), vjust = 1.3, hjust = 1.1, color = 'black', size = 2.5, angle = 66) +
scale_colour_manual(values = c('#DC4437', '#109D59', '#F5B400', '#4385F5', '#FF8483', '#58508D',
'#C67ECA', '#0154A4', '#3B3B3B' ,'#86D112'),
breaks = c("AD", 'AT', 'DA', 'DS','DU', 'MA', 'ME', 'NA',
'TI') ) +
theme(legend.title = element_text(colour = 'black', size = 10, face='bold'), legend.position = 'bottom',
legend.box = 'horizontal')
tree5
## SAVE SVG ##
ggsave(filename = "Circular_to_be_edited.tiff", width = 11, height = 11, dpi = 320)
## GENERATE TREE ##
tree2 <- ggtree(beast_tree2, aes(color = Lineage), layout = 'circular') +
geom_rootedge(0.002) +
geom_tiplab(size=2, color="black") +
geom_cladelabel(node = 340, label = 'Duero Lineage', color = '#FF6362',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -69, family = 'Times New Roman') +
geom_cladelabel(node = 211, label = 'Danubian Lineage', color = '#F5B400',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 179, label = 'Adriatic Lineage', color = '#DC4437',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -75, family = 'Times New Roman') +
geom_cladelabel(node = 205, label = 'Marmoratus Lineage', color = '#58508D',
align = T, hjust = 'centre', offset.text = 0.003, offset = 0.0025, barsize = 1.5,
angle = -48, family = 'Times New Roman') +
geom_cladelabel(node = 209, label = 'Tigris Lineage', color = '#86D112',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -57, family = 'Times New Roman') +
geom_cladelabel(node = 198, label = 'Mediterranean Lineage', color = '#C67ECA',
align = T, hjust = 'centre', offset.text = 0.002, offset = 0.0025, barsize = 1.5,
angle = -27, family = 'Times New Roman') +
geom_cladelabel(node = 194, label = 'Dades Lineage', color = '#4385F5',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -40, family = 'Times New Roman') +
geom_cladelabel(node = 264, label = 'Atlantic Lineage', color = '#109D59',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 323, label = 'North-African Lineage', color = '#0154A4',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -47, family =  'Times New Roman')
tree2
## ADD POSTERIOR VALUES ##
tree5 <- tree2 +
# #geom_text2(aes(label = node))
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(177)), hjust = 1.1,vjust= 1.5, color = 'black', size = 2.5, angle = 25) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(178)), hjust = 1.2, vjust = -.2, color = 'black', size = 2.5, angle = 46) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(179)), hjust = 1.2, vjust = -.1, color = 'black', size = 2.5, angle = 80) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(180)), hjust = -.1, vjust = 1.2, color = 'black', size = 2.5, angle = -25) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(181)), hjust = -.3, vjust = 1.3, color = 'black', size = 2.5, angle = 58) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(182)), vjust = 1.3, color = 'black', size = 2.5, angle = -65) +
# #geom_text2(aes(label = posterior, subset = node %in%
# #                         c(195)), vjust = 1.2, color = 'black', size = 2.5, angle = -40) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(196)), vjust = 1.3, color = 'black', size = 2.5, angle = -40) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(197)), vjust = 1.3, hjust = -.3, color = 'black', size = 2.5, angle = 58) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(267)), vjust = 1.3, hjust = 1.1, color = 'black', size = 2.5, angle = 66) +
scale_colour_manual(values = c('#DC4437', '#109D59', '#F5B400', '#4385F5', '#FF8483', '#58508D',
'#C67ECA', '#0154A4', '#3B3B3B' ,'#86D112'),
breaks = c("AD", 'AT', 'DA', 'DS','DU', 'MA', 'ME', 'NA',
'TI') ) +
theme(legend.title = element_text(colour = 'black', size = 10, face='bold'), legend.position = 'bottom',
legend.box = 'horizontal')
tree5
## SAVE SVG ##
ggsave(filename = "Circular_to_be_edited.tiff", width = 11, height = 11, dpi = 320)
## GENERATE TREE ##
tree2 <- ggtree(beast_tree2, aes(color = Lineage), layout = 'circular') +
geom_rootedge(0.002) +
geom_tiplab(size=2, color="black") +
geom_cladelabel(node = 340, label = 'Duero Lineage', color = '#FF6362',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -69, family = 'Times New Roman') +
geom_cladelabel(node = 211, label = 'Danubian Lineage', color = '#F5B400',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 179, label = 'Adriatic Lineage', color = '#DC4437',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -75, family = 'Times New Roman') +
geom_cladelabel(node = 205, label = 'Marmoratus Lineage', color = '#58508D',
align = T, hjust = 'centre', offset.text = 0.002, offset = 0.0025, barsize = 1.5,
angle = -48, family = 'Times New Roman') +
geom_cladelabel(node = 209, label = 'Tigris Lineage', color = '#86D112',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -57, family = 'Times New Roman') +
geom_cladelabel(node = 198, label = 'Mediterranean Lineage', color = '#C67ECA',
align = T, hjust = 'centre', offset.text = 0.002, offset = 0.0025, barsize = 1.5,
angle = -27, family = 'Times New Roman') +
geom_cladelabel(node = 194, label = 'Dades Lineage', color = '#4385F5',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -40, family = 'Times New Roman') +
geom_cladelabel(node = 264, label = 'Atlantic Lineage', color = '#109D59',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = 30, family = 'Times New Roman') +
geom_cladelabel(node = 323, label = 'North-African Lineage', color = '#0154A4',
align = T, hjust = 'centre', offset.text = 0.001, offset = 0.0025, barsize = 1.5,
angle = -47, family =  'Times New Roman')
tree2
## ADD POSTERIOR VALUES ##
tree5 <- tree2 +
# #geom_text2(aes(label = node))
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(177)), hjust = 1.1,vjust= 1.5, color = 'black', size = 2.5, angle = 25) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(178)), hjust = 1.2, vjust = -.2, color = 'black', size = 2.5, angle = 46) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(179)), hjust = 1.2, vjust = -.1, color = 'black', size = 2.5, angle = 80) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(180)), hjust = -.1, vjust = 1.2, color = 'black', size = 2.5, angle = -25) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(181)), hjust = -.3, vjust = 1.3, color = 'black', size = 2.5, angle = 58) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(182)), vjust = 1.3, color = 'black', size = 2.5, angle = -65) +
# #geom_text2(aes(label = posterior, subset = node %in%
# #                         c(195)), vjust = 1.2, color = 'black', size = 2.5, angle = -40) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(196)), vjust = 1.3, color = 'black', size = 2.5, angle = -40) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(197)), vjust = 1.3, hjust = -.3, color = 'black', size = 2.5, angle = 58) +
# geom_text2(aes(label = posterior, subset = node %in%
#                          c(267)), vjust = 1.3, hjust = 1.1, color = 'black', size = 2.5, angle = 66) +
scale_colour_manual(values = c('#DC4437', '#109D59', '#F5B400', '#4385F5', '#FF8483', '#58508D',
'#C67ECA', '#0154A4', '#3B3B3B' ,'#86D112'),
breaks = c("AD", 'AT', 'DA', 'DS','DU', 'MA', 'ME', 'NA',
'TI') ) +
theme(legend.title = element_text(colour = 'black', size = 10, face='bold'), legend.position = 'bottom',
legend.box = 'horizontal')
tree5
## SAVE SVG ##
ggsave(filename = "Circular_to_be_edited.tiff", width = 11, height = 11, dpi = 320)
setwd("/Users/eduard/Google Drive/Uni/TFG/Seqs/Named/Trees")
getwd
getwd()
## SAVE SVG ##
ggsave(filename = "Circular_to_be_edited.svg", width = 11, height = 11, dpi = 320)
## SAVE SVG ##
ggsave(filename = "Circular_to_be_edited.jpg", width = 11, height = 11, dpi = 320)
## SAVE SVG ##
ggsave(filename = "Circular_to_be_edited.png", width = 11, height = 11, dpi = 320)
library(BiocManager)
library(ggplot2)
library(treeio)
library(ggtree)
library(svglite)
library(dplyr)
library(ggpubr)
file <- "C:\Users\eduar\Google Drive\Uni\TFG\Seqs\Named\Aaaaaaaaa\annotated.tree" #Windows
file <- "C:/Users/eduar/Google Drive/Uni/TFG/Seqs/Named/Aaaaaaaaa/annotated.tree" #Windows
beast_tree <- read.beast(file)
file <- "C:/Users/eduar/Google Drive/Uni/TFG/Seqs/Named/Aaaaaaaaa/annotated.trees" #Windows
beast_tree <- read.beast(file)
as.phylo(beast_tree)
get.fields(beast_tree)
get.data(beast_tree)
file <- "C:/Users/eduar/Google Drive/Uni/TFG/Seqs/Named/Aaaaaaaaa/annotated.trees" #Windows
beast_tree <- read.beast(file)
as.phylo(beast_tree)
get.fields(beast_tree)
get.data(beast_tree)
beast_tree@data$Lineage[is.na(beast_tree@data$Lineage)] <- 'NO'
tree0 <- ggtree(beast_tree)
d <- tree0$data
d <- d[!d$isTip,]
d$label <- round(as.numeric(d$posterior),2)
d <- d[d$label > 0.50,]
tree0 + geom_text(data=d, aes(label=label), hjust=-.2)
